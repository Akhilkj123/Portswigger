- Consider a shopping application which has an insecure CORS configuration in that it trusts all origins.

![image](https://github.com/Akhilkj123/Portswigger/assets/65653010/1aa61a99-eb72-47e7-9940-49c5dd58c1a6)

- Now login to the application suing the given credentials

![image](https://github.com/Akhilkj123/Portswigger/assets/65653010/ce603c7f-c452-44f1-b76f-f8c6dcb5393a)

- Now we go into the history of /account-details

![image](https://github.com/Akhilkj123/Portswigger/assets/65653010/75e39740-b6db-439d-8bdc-74b143a88c35)

- Now we add a header to get 'Access-Control-Allow-Origin' header in the response.

![image](https://github.com/Akhilkj123/Portswigger/assets/65653010/1f7bda0b-a27d-4022-98d9-73eaa57f1c5d)

- Now we add the payload to the exploit server and deliver it to the victim.

![image](https://github.com/Akhilkj123/Portswigger/assets/65653010/5d8d9afb-c9c0-4faa-ab71-14d1a2116304)

- Now go to the access log to see the API key and paste it in  the solution to get the lab solved.

![image](https://github.com/Akhilkj123/Portswigger/assets/65653010/1ddfd7b5-7685-47d7-815e-96075a17af43)

![image](https://github.com/Akhilkj123/Portswigger/assets/65653010/91ce9577-f093-4151-8b1d-7851277f9aa3)

